import { Component, ContentChild, Directive, EventEmitter, Input, Output, ViewChild, ViewEncapsulation } from '@angular/core';
import { AudioVisualizer } from './utils/audio-visualizer';
import * as i0 from "@angular/core";
import * as i1 from "./ngx-mic-recorder.service";
import * as i2 from "@angular/common";
export class NgxMicStartStopTemplate {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
}
NgxMicStartStopTemplate.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.2.7", ngImport: i0, type: NgxMicStartStopTemplate, deps: [{ token: i0.TemplateRef }], target: i0.ɵɵFactoryTarget.Directive });
NgxMicStartStopTemplate.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "12.0.0", version: "13.2.7", type: NgxMicStartStopTemplate, selector: "[ngx-mic-start-and-stop]", ngImport: i0 });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.2.7", ngImport: i0, type: NgxMicStartStopTemplate, decorators: [{
            type: Directive,
            args: [{
                    selector: '[ngx-mic-start-and-stop]'
                }]
        }], ctorParameters: function () { return [{ type: i0.TemplateRef }]; } });
export class NgxPauseResumeTemplate {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
}
NgxPauseResumeTemplate.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.2.7", ngImport: i0, type: NgxPauseResumeTemplate, deps: [{ token: i0.TemplateRef }], target: i0.ɵɵFactoryTarget.Directive });
NgxPauseResumeTemplate.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "12.0.0", version: "13.2.7", type: NgxPauseResumeTemplate, selector: "[ngx-mic-pause-and-resume]", ngImport: i0 });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.2.7", ngImport: i0, type: NgxPauseResumeTemplate, decorators: [{
            type: Directive,
            args: [{
                    selector: '[ngx-mic-pause-and-resume]'
                }]
        }], ctorParameters: function () { return [{ type: i0.TemplateRef }]; } });
export class NgxMicRecorderComponent {
    constructor(ngxMicRecorderService) {
        this.ngxMicRecorderService = ngxMicRecorderService;
        this.showVisualization = true;
        this.getAsMp3 = new EventEmitter();
        this.getAsBlob = new EventEmitter();
        this.afterStartRecording = new EventEmitter();
        this.afterStopRecording = new EventEmitter();
        this.onPauseRecording = new EventEmitter();
        this.onResumeRecording = new EventEmitter();
    }
    ngOnInit() {
        this._subscription = this.ngxMicRecorderService.recordedBlobAsMp3$.subscribe((data) => {
            this.getAsMp3.emit({ data, url: URL.createObjectURL(data) });
        });
        this._subscription.add(this.ngxMicRecorderService.recordedBlob$.subscribe((data) => this.getAsBlob.emit(data)));
        this.ngxMicRecorderService.setRecordingEvents({
            afterStartRecording: () => this.afterStartRecording.emit(),
            afterStopRecording: (blob) => this.afterStopRecording.emit(blob),
            onPause: () => this.onPauseRecording.emit(),
            onResume: () => this.onResumeRecording.emit(),
        });
    }
    ngAfterViewInit() {
        AudioVisualizer.visualize(this.visualizationType, {
            canvas: this.canvas.nativeElement,
            ...this.visualizationOptions
        });
    }
    ngOnDestroy() {
        this._subscription?.unsubscribe();
    }
    getStartStopTemplateContext($implicit) {
        return {
            $implicit,
            toggle: this.ngxMicRecorderService.toggleStartStop,
            start: this.ngxMicRecorderService.startRecording,
            stop: this.ngxMicRecorderService.stopRecording
        };
    }
    getPauseResumeTemplateContext($implicit, isPaused, recordingTime, recordingState) {
        return {
            $implicit,
            isPaused,
            recordingState,
            recordingTime,
            toggle: this.ngxMicRecorderService.togglePauseAndResume,
            pause: this.ngxMicRecorderService.pause,
            resume: this.ngxMicRecorderService.resume
        };
    }
}
NgxMicRecorderComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.2.7", ngImport: i0, type: NgxMicRecorderComponent, deps: [{ token: i1.NgxMicRecorderService }], target: i0.ɵɵFactoryTarget.Component });
NgxMicRecorderComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.2.7", type: NgxMicRecorderComponent, selector: "ngx-mic-recorder", inputs: { showVisualization: "showVisualization", visualizationType: "visualizationType", visualizationOptions: "visualizationOptions" }, outputs: { getAsMp3: "getAsMp3", getAsBlob: "getAsBlob", afterStartRecording: "afterStartRecording", afterStopRecording: "afterStopRecording", onPauseRecording: "onPauseRecording", onResumeRecording: "onResumeRecording" }, queries: [{ propertyName: "startStopTemplateRef", first: true, predicate: NgxMicStartStopTemplate, descendants: true }, { propertyName: "pauseResumeTemplateRef", first: true, predicate: NgxPauseResumeTemplate, descendants: true }], viewQueries: [{ propertyName: "canvas", first: true, predicate: ["canvas"], descendants: true }], ngImport: i0, template: "<div class=\"ngx-mic-recorder\">\r\n  <ng-template\r\n    [ngTemplateOutlet]=\"startStopTemplateRef?.templateRef || defaultStartStopTemplate\"\r\n    [ngTemplateOutletContext]=\"getStartStopTemplateContext((ngxMicRecorderService.isRecording$ | async) ?? false)\"\r\n\r\n  ></ng-template>\r\n  <ng-template\r\n    [ngTemplateOutlet]=\"pauseResumeTemplateRef?.templateRef || defaultPauseAndResume\"\r\n    [ngTemplateOutletContext]=\"getPauseResumeTemplateContext(\r\n     (ngxMicRecorderService.isRecording$ | async) ?? false,\r\n     (ngxMicRecorderService.isPaused$ | async) ?? false,\r\n     (ngxMicRecorderService.recordingTime$ | async) ?? '00:00:00',\r\n     (ngxMicRecorderService.recordingState$ | async) ?? 'inactive'\r\n    )\"\r\n\r\n  ></ng-template>\r\n</div>\r\n\r\n<canvas *ngIf=\"showVisualization\" #canvas [class.hidden]=\"!(ngxMicRecorderService.isRecording$ | async)\"></canvas>\r\n\r\n\r\n<ng-template #defaultStartStopTemplate let-isRecording let-toggle=\"toggle\">\r\n  <div class=\"ngx-mic-recorder__start-stop\" (click)=\"toggle()\">\r\n    <div class=\"ngx-mic-recorder__state\">\r\n      <span *ngIf=\"isRecording\" class=\"ngx-mic-recorder__stop\"></span>\r\n      <svg *ngIf=\"!isRecording\" class=\"ngx-mic-recorder__start\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" aria-hidden=\"true\"\r\n           id=\"footer-sample-full\" preserveAspectRatio=\"xMidYMid meet\" viewBox=\"0 0 24 24\">\r\n        <path fill=\"currentColor\" d=\"M12 14q-1.25 0-2.125-.875T9 11V5q0-1.25.875-2.125T12 2q1.25 0 2.125.875T15 5v6q0 1.25-.875 2.125T12 14Zm-1 7v-3.075q-2.6-.35-4.3-2.325Q5 13.625 5 11h2q0 2.075 1.463 3.537Q9.925 16 12 16t3.538-1.463Q17 13.075 17 11h2q0 2.625-1.7 4.6q-1.7 1.975-4.3 2.325V21Z\"></path>\r\n      </svg>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template\r\n  #defaultPauseAndResume\r\n  let-isRecording\r\n  let-toggle=\"toggle\"\r\n  let-recordingTime=\"recordingTime\"\r\n  let-isPaused=\"isPaused\"\r\n  let-recordingState=\"recordingState\"\r\n>\r\n  <ng-template [ngIf]=\"isRecording\">\r\n    <div class=\"ngx-mic-recorder__recording-time\">\r\n      {{ recordingTime }}\r\n    </div>\r\n    <div class=\"ngx-mic-recorder__toggle\" (click)=\"toggle()\">\r\n      <span [class.blink]=\"!isPaused\"></span>\r\n      <p>{{ recordingState }}</p>\r\n    </div>\r\n  </ng-template>\r\n</ng-template>\r\n", styles: ["ngx-mic-recorder{width:400px;display:block}ngx-mic-recorder>*{box-sizing:border-box}ngx-mic-recorder>canvas{width:100%}.ngx-mic-recorder{display:flex;align-items:center;justify-content:space-between}.ngx-mic-recorder__recording-time{color:#282828;font-size:24px;font-weight:700}.ngx-mic-recorder__state{width:24px;height:24px}.ngx-mic-recorder__start-stop{padding:16px;background-color:#282828;border-radius:50px;border:4px solid #CFCFCF;cursor:pointer}.ngx-mic-recorder__start-stop .ngx-mic-recorder__stop{background-color:#cfcfcf;border-radius:4px;width:100%;height:100%;display:block}.ngx-mic-recorder__start-stop .ngx-mic-recorder__start{color:#cfcfcf;width:100%;height:100%}.ngx-mic-recorder__toggle{padding:16px 48px;background-color:#282828;border-radius:50px;border:4px solid #CFCFCF;cursor:pointer;color:#cfcfcf;display:flex;align-items:center}.ngx-mic-recorder__toggle>span{background-color:#d40100;border-radius:50%;width:24px;height:24px;display:block;margin-inline-end:8px}.ngx-mic-recorder__toggle>p{margin:0;width:60px;text-transform:capitalize}.hidden{visibility:hidden}.blink{animation-name:blink;animation-duration:1s;animation-iteration-count:infinite}@keyframes blink{0%{opacity:1}50%{opacity:.3}to{opacity:1}}\n"], directives: [{ type: i2.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet"] }, { type: i2.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }], pipes: { "async": i2.AsyncPipe }, encapsulation: i0.ViewEncapsulation.None });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.2.7", ngImport: i0, type: NgxMicRecorderComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ngx-mic-recorder', encapsulation: ViewEncapsulation.None, template: "<div class=\"ngx-mic-recorder\">\r\n  <ng-template\r\n    [ngTemplateOutlet]=\"startStopTemplateRef?.templateRef || defaultStartStopTemplate\"\r\n    [ngTemplateOutletContext]=\"getStartStopTemplateContext((ngxMicRecorderService.isRecording$ | async) ?? false)\"\r\n\r\n  ></ng-template>\r\n  <ng-template\r\n    [ngTemplateOutlet]=\"pauseResumeTemplateRef?.templateRef || defaultPauseAndResume\"\r\n    [ngTemplateOutletContext]=\"getPauseResumeTemplateContext(\r\n     (ngxMicRecorderService.isRecording$ | async) ?? false,\r\n     (ngxMicRecorderService.isPaused$ | async) ?? false,\r\n     (ngxMicRecorderService.recordingTime$ | async) ?? '00:00:00',\r\n     (ngxMicRecorderService.recordingState$ | async) ?? 'inactive'\r\n    )\"\r\n\r\n  ></ng-template>\r\n</div>\r\n\r\n<canvas *ngIf=\"showVisualization\" #canvas [class.hidden]=\"!(ngxMicRecorderService.isRecording$ | async)\"></canvas>\r\n\r\n\r\n<ng-template #defaultStartStopTemplate let-isRecording let-toggle=\"toggle\">\r\n  <div class=\"ngx-mic-recorder__start-stop\" (click)=\"toggle()\">\r\n    <div class=\"ngx-mic-recorder__state\">\r\n      <span *ngIf=\"isRecording\" class=\"ngx-mic-recorder__stop\"></span>\r\n      <svg *ngIf=\"!isRecording\" class=\"ngx-mic-recorder__start\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" aria-hidden=\"true\"\r\n           id=\"footer-sample-full\" preserveAspectRatio=\"xMidYMid meet\" viewBox=\"0 0 24 24\">\r\n        <path fill=\"currentColor\" d=\"M12 14q-1.25 0-2.125-.875T9 11V5q0-1.25.875-2.125T12 2q1.25 0 2.125.875T15 5v6q0 1.25-.875 2.125T12 14Zm-1 7v-3.075q-2.6-.35-4.3-2.325Q5 13.625 5 11h2q0 2.075 1.463 3.537Q9.925 16 12 16t3.538-1.463Q17 13.075 17 11h2q0 2.625-1.7 4.6q-1.7 1.975-4.3 2.325V21Z\"></path>\r\n      </svg>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template\r\n  #defaultPauseAndResume\r\n  let-isRecording\r\n  let-toggle=\"toggle\"\r\n  let-recordingTime=\"recordingTime\"\r\n  let-isPaused=\"isPaused\"\r\n  let-recordingState=\"recordingState\"\r\n>\r\n  <ng-template [ngIf]=\"isRecording\">\r\n    <div class=\"ngx-mic-recorder__recording-time\">\r\n      {{ recordingTime }}\r\n    </div>\r\n    <div class=\"ngx-mic-recorder__toggle\" (click)=\"toggle()\">\r\n      <span [class.blink]=\"!isPaused\"></span>\r\n      <p>{{ recordingState }}</p>\r\n    </div>\r\n  </ng-template>\r\n</ng-template>\r\n", styles: ["ngx-mic-recorder{width:400px;display:block}ngx-mic-recorder>*{box-sizing:border-box}ngx-mic-recorder>canvas{width:100%}.ngx-mic-recorder{display:flex;align-items:center;justify-content:space-between}.ngx-mic-recorder__recording-time{color:#282828;font-size:24px;font-weight:700}.ngx-mic-recorder__state{width:24px;height:24px}.ngx-mic-recorder__start-stop{padding:16px;background-color:#282828;border-radius:50px;border:4px solid #CFCFCF;cursor:pointer}.ngx-mic-recorder__start-stop .ngx-mic-recorder__stop{background-color:#cfcfcf;border-radius:4px;width:100%;height:100%;display:block}.ngx-mic-recorder__start-stop .ngx-mic-recorder__start{color:#cfcfcf;width:100%;height:100%}.ngx-mic-recorder__toggle{padding:16px 48px;background-color:#282828;border-radius:50px;border:4px solid #CFCFCF;cursor:pointer;color:#cfcfcf;display:flex;align-items:center}.ngx-mic-recorder__toggle>span{background-color:#d40100;border-radius:50%;width:24px;height:24px;display:block;margin-inline-end:8px}.ngx-mic-recorder__toggle>p{margin:0;width:60px;text-transform:capitalize}.hidden{visibility:hidden}.blink{animation-name:blink;animation-duration:1s;animation-iteration-count:infinite}@keyframes blink{0%{opacity:1}50%{opacity:.3}to{opacity:1}}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.NgxMicRecorderService }]; }, propDecorators: { canvas: [{
                type: ViewChild,
                args: ['canvas']
            }], startStopTemplateRef: [{
                type: ContentChild,
                args: [NgxMicStartStopTemplate]
            }], pauseResumeTemplateRef: [{
                type: ContentChild,
                args: [NgxPauseResumeTemplate]
            }], showVisualization: [{
                type: Input
            }], visualizationType: [{
                type: Input
            }], visualizationOptions: [{
                type: Input
            }], getAsMp3: [{
                type: Output
            }], getAsBlob: [{
                type: Output
            }], afterStartRecording: [{
                type: Output
            }], afterStopRecording: [{
                type: Output
            }], onPauseRecording: [{
                type: Output
            }], onResumeRecording: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LW1pYy1yZWNvcmRlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtbWljLXJlY29yZGVyL3NyYy9saWIvbmd4LW1pYy1yZWNvcmRlci5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtbWljLXJlY29yZGVyL3NyYy9saWIvbmd4LW1pYy1yZWNvcmRlci5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBRUwsU0FBUyxFQUNULFlBQVksRUFDWixTQUFTLEVBRVQsWUFBWSxFQUNaLEtBQUssRUFHTCxNQUFNLEVBRU4sU0FBUyxFQUNULGlCQUFpQixFQUNsQixNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEVBQXFELGVBQWUsRUFBRSxNQUFNLDBCQUEwQixDQUFDOzs7O0FBa0I5RyxNQUFNLE9BQU8sdUJBQXVCO0lBQ2xDLFlBQW1CLFdBQWtEO1FBQWxELGdCQUFXLEdBQVgsV0FBVyxDQUF1QztJQUNyRSxDQUFDOztvSEFGVSx1QkFBdUI7d0dBQXZCLHVCQUF1QjsyRkFBdkIsdUJBQXVCO2tCQUhuQyxTQUFTO21CQUFDO29CQUNULFFBQVEsRUFBRSwwQkFBMEI7aUJBQ3JDOztBQVNELE1BQU0sT0FBTyxzQkFBc0I7SUFDakMsWUFBbUIsV0FBb0Q7UUFBcEQsZ0JBQVcsR0FBWCxXQUFXLENBQXlDO0lBQUcsQ0FBQzs7bUhBRGhFLHNCQUFzQjt1R0FBdEIsc0JBQXNCOzJGQUF0QixzQkFBc0I7a0JBSGxDLFNBQVM7bUJBQUM7b0JBQ1QsUUFBUSxFQUFFLDRCQUE0QjtpQkFDdkM7O0FBV0QsTUFBTSxPQUFPLHVCQUF1QjtJQWdCbEMsWUFBbUIscUJBQTRDO1FBQTVDLDBCQUFxQixHQUFyQixxQkFBcUIsQ0FBdUI7UUFadEQsc0JBQWlCLEdBQUcsSUFBSSxDQUFDO1FBR3hCLGFBQVEsR0FBRyxJQUFJLFlBQVksRUFBOEIsQ0FB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QkFDQyxzQkFBc0I7c0JBQTNELFlBQVk7dUJBQUMsc0JBQXNCO2dCQUMzQixpQkFBaUI7c0JBQXpCLEtBQUs7Z0JBQ0csaUJBQWlCO3NCQUF6QixLQUFLO2dCQUNHLG9CQUFvQjtzQkFBNUIsS0FBSztnQkFDSSxRQUFRO3NCQUFqQixNQUFNO2dCQUNHLFNBQVM7c0JBQWxCLE1BQU07Z0JBQ0csbUJBQW1CO3NCQUE1QixNQUFNO2dCQUNHLGtCQUFrQjtzQkFBM0IsTUFBTTtnQkFDRyxnQkFBZ0I7c0JBQXpCLE1BQU07Z0JBQ0csaUJBQWlCO3NCQUExQixNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICBBZnRlclZpZXdJbml0LFxyXG4gIENvbXBvbmVudCxcclxuICBDb250ZW50Q2hpbGQsXHJcbiAgRGlyZWN0aXZlLFxyXG4gIEVsZW1lbnRSZWYsXHJcbiAgRXZlbnRFbWl0dGVyLFxyXG4gIElucHV0LFxyXG4gIE9uRGVzdHJveSxcclxuICBPbkluaXQsXHJcbiAgT3V0cHV0LFxyXG4gIFRlbXBsYXRlUmVmLFxyXG4gIFZpZXdDaGlsZCxcclxuICBWaWV3RW5jYXBzdWxhdGlvblxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBOZ3hNaWNSZWNvcmRlclNlcnZpY2UgfSBmcm9tICcuL25neC1taWMtcmVjb3JkZXIuc2VydmljZSc7XHJcbmltcG9ydCB7IEF1ZGlvVmlzdWFsaXphdGlvbk9wdGlvbnMsIEF1ZGlvVmlzdWFsaXphdGlvblR5cGUsIEF1ZGlvVmlzdWFsaXplciB9IGZyb20gJy4vdXRpbHMvYXVkaW8tdmlzdWFsaXplcic7XHJcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xyXG5cclxudHlwZSBTdGFydFN0b3BUZW1wbGF0ZUNvbnRleHQgPSB7ICRpbXBsaWNpdDogYm9vbGVhbiwgdG9nZ2xlOiBGdW5jdGlvbiwgc3RhcnQ6IEZ1bmN0aW9uLCBzdG9wOiBGdW5jdGlvbn07XHJcblxyXG50eXBlIFBhdXNlUmVzdW1lVGVtcGxhdGVDb250ZXh0ID0ge1xyXG4gICRpbXBsaWNpdDogYm9vbGVhbixcclxuICBpc1BhdXNlZDogYm9vbGVhbixcclxuICB0b2dnbGU6IEZ1bmN0aW9uLFxyXG4gIHJlc3VtZTogRnVuY3Rpb24sXHJcbiAgcGF1c2U6IEZ1bmN0aW9uLFxyXG4gIHJlY29yZGluZ1N0YXRlOiBSZWNvcmRpbmdTdGF0ZSxcclxuICByZWNvcmRpbmdUaW1lOiBzdHJpbmdcclxufTtcclxuXHJcbkBEaXJlY3RpdmUoe1xyXG4gIHNlbGVjdG9yOiAnW25neC1taWMtc3RhcnQtYW5kLXN0b3BdJ1xyXG59KVxyXG5leHBvcnQgY2xhc3MgTmd4TWljU3RhcnRTdG9wVGVtcGxhdGUge1xyXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyB0ZW1wbGF0ZVJlZjogVGVtcGxhdGVSZWY8U3RhcnRTdG9wVGVtcGxhdGVDb250ZXh0Pikge1xyXG4gIH1cclxufVxyXG5cclxuQERpcmVjdGl2ZSh7XHJcbiAgc2VsZWN0b3I6ICdbbmd4LW1pYy1wYXVzZS1hbmQtcmVzdW1lXSdcclxufSlcclxuZXhwb3J0IGNsYXNzIE5neFBhdXNlUmVzdW1lVGVtcGxhdGUge1xyXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyB0ZW1wbGF0ZVJlZjogVGVtcGxhdGVSZWY8UGF1c2VSZXN1bWVUZW1wbGF0ZUNvbnRleHQ+KSB7fVxyXG59XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ25neC1taWMtcmVjb3JkZXInLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9uZ3gtbWljLXJlY29yZGVyLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9uZ3gtbWljLXJlY29yZGVyLmNvbXBvbmVudC5zY3NzJ10sXHJcbiAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxyXG59KVxyXG5leHBvcnQgY2xhc3MgTmd4TWljUmVjb3JkZXJDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyVmlld0luaXQsIE9uRGVzdHJveSB7XHJcbiAgQFZpZXdDaGlsZCgnY2FudmFzJykgY2FudmFzITogRWxlbWVudFJlZjxIVE1MQ2FudmFzRWxlbWVudD47XHJcbiAgQENvbnRlbnRDaGlsZChOZ3hNaWNTdGFydFN0b3BUZW1wbGF0ZSkgc3RhcnRTdG9wVGVtcGxhdGVSZWY/OiBOZ3hNaWNTdGFydFN0b3BUZW1wbGF0ZTtcclxuICBAQ29udGVudENoaWxkKE5neFBhdXNlUmVzdW1lVGVtcGxhdGUpIHBhdXNlUmVzdW1lVGVtcGxhdGVSZWY/OiBOZ3hQYXVzZVJlc3VtZVRlbXBsYXRlO1xyXG4gIEBJbnB1dCgpIHNob3dWaXN1YWxpemF0aW9uID0gdHJ1ZTtcclxuICBASW5wdXQoKSB2aXN1YWxpemF0aW9uVHlwZT86IEF1ZGlvVmlzdWFsaXphdGlvblR5cGU7XHJcbiAgQElucHV0KCkgdmlzdWFsaXphdGlvbk9wdGlvbnM/OiBPbWl0PEF1ZGlvVmlzdWFsaXphdGlvbk9wdGlvbnMsICdjYW52YXMnPjtcclxuICBAT3V0cHV0KCkgZ2V0QXNNcDMgPSBuZXcgRXZlbnRFbWl0dGVyPHsgZGF0YTogQmxvYiwgdXJsOiBzdHJpbmd9PigpO1xyXG4gIEBPdXRwdXQoKSBnZXRBc0Jsb2IgPSBuZXcgRXZlbnRFbWl0dGVyPEJsb2I+KCk7XHJcbiAgQE91dHB1dCgpIGFmdGVyU3RhcnRSZWNvcmRpbmcgPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XHJcbiAgQE91dHB1dCgpIGFmdGVyU3RvcFJlY29yZGluZyA9IG5ldyBFdmVudEVtaXR0ZXI8QmxvYj4oKTtcclxuICBAT3V0cHV0KCkgb25QYXVzZVJlY29yZGluZyA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcclxuICBAT3V0cHV0KCkgb25SZXN1bWVSZWNvcmRpbmcgPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XHJcblxyXG4gIHByaXZhdGUgX3N1YnNjcmlwdGlvbj86IFN1YnNjcmlwdGlvbjtcclxuXHJcbiAgY29uc3RydWN0b3IocHVibGljIG5neE1pY1JlY29yZGVyU2VydmljZTogTmd4TWljUmVjb3JkZXJTZXJ2aWNlKSB7IH1cclxuXHJcbiAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLl9zdWJzY3JpcHRpb24gPSB0aGlzLm5neE1pY1JlY29yZGVyU2VydmljZS5yZWNvcmRlZEJsb2JBc01wMyQuc3Vic2NyaWJlKFxyXG4gICAgICAoZGF0YSkgPT4ge1xyXG4gICAgICAgIHRoaXMuZ2V0QXNNcDMuZW1pdCh7ZGF0YSwgdXJsOiBVUkwuY3JlYXRlT2JqZWN0VVJMKGRhdGEpfSlcclxuICAgICAgfVxyXG4gICAgKVxyXG4gICAgdGhpcy5fc3Vic2NyaXB0aW9uLmFkZChcclxuICAgICAgdGhpcy5uZ3hNaWNSZWNvcmRlclNlcnZpY2UucmVjb3JkZWRCbG9iJC5zdWJzY3JpYmUoKGRhdGEpID0+IHRoaXMuZ2V0QXNCbG9iLmVtaXQoZGF0YSEpKVxyXG4gICAgKVxyXG5cclxuICAgIHRoaXMubmd4TWljUmVjb3JkZXJTZXJ2aWNlLnNldFJlY29yZGluZ0V2ZW50cyh7XHJcbiAgICAgIGFmdGVyU3RhcnRSZWNvcmRpbmc6ICgpID0+IHRoaXMuYWZ0ZXJTdGFydFJlY29yZGluZy5lbWl0KCksXHJcbiAgICAgIGFmdGVyU3RvcFJlY29yZGluZzogKGJsb2IpID0+IHRoaXMuYWZ0ZXJTdG9wUmVjb3JkaW5nLmVtaXQoYmxvYiksXHJcbiAgICAgIG9uUGF1c2U6ICgpID0+IHRoaXMub25QYXVzZVJlY29yZGluZy5lbWl0KCksXHJcbiAgICAgIG9uUmVzdW1lOiAoKSA9PiB0aGlzLm9uUmVzdW1lUmVjb3JkaW5nLmVtaXQoKSxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XHJcbiAgICBBdWRpb1Zpc3VhbGl6ZXIudmlzdWFsaXplKHRoaXMudmlzdWFsaXphdGlvblR5cGUsIHtcclxuICAgICAgY2FudmFzOiB0aGlzLmNhbnZhcy5uYXRpdmVFbGVtZW50LFxyXG4gICAgICAuLi50aGlzLnZpc3VhbGl6YXRpb25PcHRpb25zXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XHJcbiAgICB0aGlzLl9zdWJzY3JpcHRpb24/LnVuc3Vic2NyaWJlKCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0U3RhcnRTdG9wVGVtcGxhdGVDb250ZXh0KCRpbXBsaWNpdDogYm9vbGVhbik6IFN0YXJ0U3RvcFRlbXBsYXRlQ29udGV4dCB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAkaW1wbGljaXQsXHJcbiAgICAgIHRvZ2dsZTogdGhpcy5uZ3hNaWNSZWNvcmRlclNlcnZpY2UudG9nZ2xlU3RhcnRTdG9wLFxyXG4gICAgICBzdGFydDogdGhpcy5uZ3hNaWNSZWNvcmRlclNlcnZpY2Uuc3RhcnRSZWNvcmRpbmcsXHJcbiAgICAgIHN0b3A6IHRoaXMubmd4TWljUmVjb3JkZXJTZXJ2aWNlLnN0b3BSZWNvcmRpbmdcclxuICAgIH1cclxuICB9XHJcblxyXG5cclxuICBwdWJsaWMgZ2V0UGF1c2VSZXN1bWVUZW1wbGF0ZUNvbnRleHQoJGltcGxpY2l0OiBib29sZWFuLCBpc1BhdXNlZDogYm9vbGVhbiwgcmVjb3JkaW5nVGltZTogc3RyaW5nLCByZWNvcmRpbmdTdGF0ZTogUmVjb3JkaW5nU3RhdGUpOiBQYXVzZVJlc3VtZVRlbXBsYXRlQ29udGV4dCB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAkaW1wbGljaXQsXHJcbiAgICAgIGlzUGF1c2VkLFxyXG4gICAgICByZWNvcmRpbmdTdGF0ZSxcclxuICAgICAgcmVjb3JkaW5nVGltZSxcclxuICAgICAgdG9nZ2xlOiB0aGlzLm5neE1pY1JlY29yZGVyU2VydmljZS50b2dnbGVQYXVzZUFuZFJlc3VtZSxcclxuICAgICAgcGF1c2U6IHRoaXMubmd4TWljUmVjb3JkZXJTZXJ2aWNlLnBhdXNlLFxyXG4gICAgICByZXN1bWU6IHRoaXMubmd4TWljUmVjb3JkZXJTZXJ2aWNlLnJlc3VtZVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCI8ZGl2IGNsYXNzPVwibmd4LW1pYy1yZWNvcmRlclwiPlxyXG4gIDxuZy10ZW1wbGF0ZVxyXG4gICAgW25nVGVtcGxhdGVPdXRsZXRdPVwic3RhcnRTdG9wVGVtcGxhdGVSZWY/LnRlbXBsYXRlUmVmIHx8IGRlZmF1bHRTdGFydFN0b3BUZW1wbGF0ZVwiXHJcbiAgICBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwiZ2V0U3RhcnRTdG9wVGVtcGxhdGVDb250ZXh0KChuZ3hNaWNSZWNvcmRlclNlcnZpY2UuaXNSZWNvcmRpbmckIHwgYXN5bmMpID8/IGZhbHNlKVwiXHJcblxyXG4gID48L25nLXRlbXBsYXRlPlxyXG4gIDxuZy10ZW1wbGF0ZVxyXG4gICAgW25nVGVtcGxhdGVPdXRsZXRdPVwicGF1c2VSZXN1bWVUZW1wbGF0ZVJlZj8udGVtcGxhdGVSZWYgfHwgZGVmYXVsdFBhdXNlQW5kUmVzdW1lXCJcclxuICAgIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJnZXRQYXVzZVJlc3VtZVRlbXBsYXRlQ29udGV4dChcclxuICAgICAobmd4TWljUmVjb3JkZXJTZXJ2aWNlLmlzUmVjb3JkaW5nJCB8IGFzeW5jKSA/PyBmYWxzZSxcclxuICAgICAobmd4TWljUmVjb3JkZXJTZXJ2aWNlLmlzUGF1c2VkJCB8IGFzeW5jKSA/PyBmYWxzZSxcclxuICAgICAobmd4TWljUmVjb3JkZXJTZXJ2aWNlLnJlY29yZGluZ1RpbWUkIHwgYXN5bmMpID8/ICcwMDowMDowMCcsXHJcbiAgICAgKG5neE1pY1JlY29yZGVyU2VydmljZS5yZWNvcmRpbmdTdGF0ZSQgfCBhc3luYykgPz8gJ2luYWN0aXZlJ1xyXG4gICAgKVwiXHJcblxyXG4gID48L25nLXRlbXBsYXRlPlxyXG48L2Rpdj5cclxuXHJcbjxjYW52YXMgKm5nSWY9XCJzaG93VmlzdWFsaXphdGlvblwiICNjYW52YXMgW2NsYXNzLmhpZGRlbl09XCIhKG5neE1pY1JlY29yZGVyU2VydmljZS5pc1JlY29yZGluZyQgfCBhc3luYylcIj48L2NhbnZhcz5cclxuXHJcblxyXG48bmctdGVtcGxhdGUgI2RlZmF1bHRTdGFydFN0b3BUZW1wbGF0ZSBsZXQtaXNSZWNvcmRpbmcgbGV0LXRvZ2dsZT1cInRvZ2dsZVwiPlxyXG4gIDxkaXYgY2xhc3M9XCJuZ3gtbWljLXJlY29yZGVyX19zdGFydC1zdG9wXCIgKGNsaWNrKT1cInRvZ2dsZSgpXCI+XHJcbiAgICA8ZGl2IGNsYXNzPVwibmd4LW1pYy1yZWNvcmRlcl9fc3RhdGVcIj5cclxuICAgICAgPHNwYW4gKm5nSWY9XCJpc1JlY29yZGluZ1wiIGNsYXNzPVwibmd4LW1pYy1yZWNvcmRlcl9fc3RvcFwiPjwvc3Bhbj5cclxuICAgICAgPHN2ZyAqbmdJZj1cIiFpc1JlY29yZGluZ1wiIGNsYXNzPVwibmd4LW1pYy1yZWNvcmRlcl9fc3RhcnRcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgeG1sbnM6eGxpbms9XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCJcclxuICAgICAgICAgICBpZD1cImZvb3Rlci1zYW1wbGUtZnVsbFwiIHByZXNlcnZlQXNwZWN0UmF0aW89XCJ4TWlkWU1pZCBtZWV0XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiPlxyXG4gICAgICAgIDxwYXRoIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBkPVwiTTEyIDE0cS0xLjI1IDAtMi4xMjUtLjg3NVQ5IDExVjVxMC0xLjI1Ljg3NS0yLjEyNVQxMiAycTEuMjUgMCAyLjEyNS44NzVUMTUgNXY2cTAgMS4yNS0uODc1IDIuMTI1VDEyIDE0Wm0tMSA3di0zLjA3NXEtMi42LS4zNS00LjMtMi4zMjVRNSAxMy42MjUgNSAxMWgycTAgMi4wNzUgMS40NjMgMy41MzdROS45MjUgMTYgMTIgMTZ0My41MzgtMS40NjNRMTcgMTMuMDc1IDE3IDExaDJxMCAyLjYyNS0xLjcgNC42cS0xLjcgMS45NzUtNC4zIDIuMzI1VjIxWlwiPjwvcGF0aD5cclxuICAgICAgPC9zdmc+XHJcbiAgICA8L2Rpdj5cclxuICA8L2Rpdj5cclxuPC9uZy10ZW1wbGF0ZT5cclxuXHJcbjxuZy10ZW1wbGF0ZVxyXG4gICNkZWZhdWx0UGF1c2VBbmRSZXN1bWVcclxuICBsZXQtaXNSZWNvcmRpbmdcclxuICBsZXQtdG9nZ2xlPVwidG9nZ2xlXCJcclxuICBsZXQtcmVjb3JkaW5nVGltZT1cInJlY29yZGluZ1RpbWVcIlxyXG4gIGxldC1pc1BhdXNlZD1cImlzUGF1c2VkXCJcclxuICBsZXQtcmVjb3JkaW5nU3RhdGU9XCJyZWNvcmRpbmdTdGF0ZVwiXHJcbj5cclxuICA8bmctdGVtcGxhdGUgW25nSWZdPVwiaXNSZWNvcmRpbmdcIj5cclxuICAgIDxkaXYgY2xhc3M9XCJuZ3gtbWljLXJlY29yZGVyX19yZWNvcmRpbmctdGltZVwiPlxyXG4gICAgICB7eyByZWNvcmRpbmdUaW1lIH19XHJcbiAgICA8L2Rpdj5cclxuICAgIDxkaXYgY2xhc3M9XCJuZ3gtbWljLXJlY29yZGVyX190b2dnbGVcIiAoY2xpY2spPVwidG9nZ2xlKClcIj5cclxuICAgICAgPHNwYW4gW2NsYXNzLmJsaW5rXT1cIiFpc1BhdXNlZFwiPjwvc3Bhbj5cclxuICAgICAgPHA+e3sgcmVjb3JkaW5nU3RhdGUgfX08L3A+XHJcbiAgICA8L2Rpdj5cclxuICA8L25nLXRlbXBsYXRlPlxyXG48L25nLXRlbXBsYXRlPlxyXG4iXX0=